<% layout('layouts/boilerplate') %>

<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 text-primary">Your Cart</h1>
        <a href="/books" class="btn btn-primary">
          <i class="fas fa-arrow-left me-2"></i>Back to Books
        </a>
      </div>

      <% if (cart.length > 0) { %>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          <% cart.forEach(item => { %>
            <div class="col">
              <div class="card h-100 shadow-sm">
                <div class="position-relative overflow-hidden" style="height: 200px;">
                  <img src="<%= item.image.url %>" alt="<%= item.title %>" class="card-img-top h-100 object-fit-cover">
                </div>
                
                <div class="card-body">
                  <h3 class="card-title h5"><%= item.title %></h3>
                  <p class="text-muted mb-2">by <%= item.author %></p>
                  <p class="fw-bold text-primary fs-5 mb-3">$<%= item.price.toFixed(2) %></p>
                  
                  <div class="d-grid gap-2">
                    <form action="/checkout" method="get">
                      <input type="hidden" name="bookId" value="<%= item._id %>">
                      <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-credit-card me-2"></i>Checkout
                      </button>
                    </form>
                    
                    <form action="/cart/remove" method="POST">
                      <input type="hidden" name="bookId" value="<%= item._id %>">
                      <button type="submit" class="btn btn-danger w-100">
                        <i class="fas fa-trash-alt me-2"></i>Remove
                      </button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          <% }) %>
        </div>
      <% } else { %>
        <div class="alert alert-info text-center p-5">
          <i class="fas fa-shopping-cart fa-3x mb-3"></i>
          <p class="mb-3">Your cart is empty</p>
          <a href="/books" class="btn btn-primary">
            <i class="fas fa-book me-2"></i>Browse Books
          </a>
        </div>
      <% } %>
    </div>
  </div>
</div>
